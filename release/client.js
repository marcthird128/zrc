(()=>{var e={16:e=>{"use strict";e.exports=require("url")},224:e=>{e.exports={initialized:!1,autoRestart:!1}},317:e=>{"use strict";e.exports=require("child_process")},318:(e,t,r)=>{const{spawn:s}=r(317),o=r(224);function n(){console.log("Starting new client");let e="win32"===process.platform?"start.bat":"start.sh";s(e,{shell:!0,detached:!0})}e.exports={fatal:function(e){e="[31m[FATAL] "+e+"[0m\n",process.stdout.write(e),process.stderr.write(e),o.autoRestart&&n(),console.log("Exiting"),process.exit(1)},error:function(e){e="[1;31m[ERROR] "+e+"\n[0m",process.stdout.write(e),process.stderr.write(e)},warn:function(e){e="[1;33m[WARN] "+e+"\n[0m",process.stdout.write(e)},log:function(e){e="[1m[LOG][0m "+e+"\n",process.stdout.write(e)},startClient:n}},345:(e,t,r)=>{const s=r(896),{fatal:o,error:n,log:i}=r(318);e.exports={load:function e(){let t;i("Loading config");try{t=s.readFileSync("./config.json",{encoding:"utf8"})}catch(t){n("Could not load config file: "+t.message),i("Creating default config");try{return s.writeFileSync("./config.json",'{\n    "autoRestart": false,\n    "client": "127.0.0.1:65535",\n    "server": "10.0.0.65:65535"\n}'),i("Trying to load config again"),e()}catch(e){o("Could not create config: "+e.message)}}try{return JSON.parse(t)}catch(e){o("Could not parse config: "+e.message)}}}},408:(e,t,r)=>{const s=r(611),o=(r(16),r(896)),n=r(928),i=r(224),{fatal:a,error:c,warn:l,log:d}=r(318);function u(e,t){d("Got request for "+e.url);let r=null;try{r=JSON.parse(atob(e.url.substring(1)))}catch(e){return c("Bad request body: "+e.message),t.end()}if(void 0===r.type)return c('Expected "type" property in obj'),t.end();if("fsget"==r.type){if(void 0===r.path)return c('Expected "path" property in fsget request'),t.end();let e,s="win32"==process.platform?"C:/":"/",i=n.join(s,r.path);try{e=o.lstatSync(i).isDirectory()}catch(e){return c(`Error checking if "${i}" is a directory: ${e.message}`),t.end(`{"status":"error","message":"${btoa(e.message)}"}`)}e?o.readdir(i,((e,r)=>{e?(c('Error reading dir "'+i+'": '+e.message),t.end(`{"status":"error","message":"${btoa(e.message)}"}`)):t.end(`{"status":"ok","type":"dir","data":"${btoa(JSON.stringify(r))}"}`)})):o.readFile(i,((e,r)=>{e?(c('Error reading file "'+i+'": '+e.message),t.end(`{"status":"error","message":"${btoa(e.message)}"}`)):t.end(`{"status":"ok","type":"file","data":"${btoa(r)}"}`)}))}}e.exports={init:function(){i.clientServer=s.createServer(u);const e=i.config.client.split(":");i.clientServer.listen(+e[1],e[0]),d("Client server listening on "+i.config.client)}}},545:(e,t,r)=>{r(896),r(224);const{fatal:s}=r(318);function o(e){s("[!] Unhandled Error: "+e.stack)}process.on("uncaughtException",o),process.on("unhandledRejection",o)},611:e=>{"use strict";e.exports=require("http")},896:e=>{"use strict";e.exports=require("fs")},928:e=>{"use strict";e.exports=require("path")}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}r(545),r(896);const s=r(224),{log:o}=r(318),n=r(345),i=r(408);console.log("[1mZRC Client v1.0.0[0m"),console.log(),o("Loading..."),s.config=n.load(),o("Loaded config"),o("Creating client HTTP server"),i.init(),o("Created client HTTP server"),s.initialized=!0,o("Initialized ZRC client")})();